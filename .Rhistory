rm(list=ls(all=TRUE)) # remove any objects from old R sessions
# set the directory for the data (and any files saved)
#setwd("C:\\Data\\FRST531\\yFRST531 2020-21\\Module 4 Principal Components Analysis\\Exercise 2 PCA")
#dir()
fatdat<- read.table("pca.txt", header=T)
#fatdat<-read.csv("pca.csv", header=T) # would read a comma delimited file this way instead.
str(fatdat)   # what is in this file?  Uses $ before each item in the file
names(fatdat)  # print out the column (i.e., variable) names
dim(fatdat)    # number of rows and columns
head(fatdat)  # print out the first few lines of data
fatdat[1,]    # print out the first line of data
fatdat[,1]    # print out the first column of data
fatdat$wt2    # print out the wt2 values
fatdat[1:3,1:2]  # print out lines 1 to 3 and columns 1 and 2
library(pastecs) # won't work if you have not installed the package first!!
install.packages("pastecs")
rm(list=ls(all=TRUE)) # remove any objects from old R sessions
# set the directory for the data (and any files saved)
#setwd("C:\\Data\\FRST531\\yFRST531 2020-21\\Module 4 Principal Components Analysis\\Exercise 2 PCA")
#dir()
rm(list=ls(all=TRUE)) # remove any objects from old R sessions
# set the directory for the data (and any files saved)
#setwd("C:\\Data\\FRST531\\yFRST531 2020-21\\Module 4 Principal Components Analysis\\Exercise 2 PCA")
#dir()
fatdat<- read.table("pca.txt", header=T)
#fatdat<-read.csv("pca.csv", header=T) # would read a comma delimited file this way instead.
str(fatdat)   # what is in this file?  Uses $ before each item in the file
names(fatdat)  # print out the column (i.e., variable) names
dim(fatdat)    # number of rows and columns
head(fatdat)  # print out the first few lines of data
fatdat[1,]    # print out the first line of data
fatdat[,1]    # print out the first column of data
fatdat$wt2    # print out the wt2 values
fatdat[1:3,1:2]  # print out lines 1 to 3 and columns 1 and 2
library(pastecs) # won't work if you have not installed the package first!!
options(digits=2) # set the number of decimals to be 2
stat.desc(fatdat) # get some basic stats.
xdata<-fatdat[,1:10] # save the x variables (columns 1 to 10)
xdata<-fatdat[,1:10] # save the x variables (columns 1 to 10)
names(xdata)
pairs(xdata, pch = 1,col="blue")  # huge graph as there are 10 x-variables.
round(( cor(xdata)),3) # round( ) is used to round to the nearest 3 decimal places.
xdata.pca <- princomp(xdata, cor=TRUE,scores=TRUE)
class(xdata.pca) # confirm that this gave us a princomp object.
str(xdata.pca) # what is in this list object?  Lots of stuff
methods(class=princomp)  # show the information we can ask for from the princomp object
summary(xdata.pca, loadings=TRUE,cutoff=0.0)  # cutoff insures all are displayed
screeplot(xdata.pca) # NOTE that this does show the PC variances.
plot(xdata.pca$sdev^2, type="b", pch=16, xlab="Component number",
ylab="Eigenvalue", main="Scree plot for x-variables of fat data")
table<-round(cbind("Variance"=xdata.pca$sdev^2,
"%"=100*xdata.pca$sdev^2/sum(xdata.pca$sdev^2),
"Cumulative %"=100*cumsum(xdata.pca$sdev^2)/sum(xdata.pca$sdev^2)),
d=2)
knitr::kable(table) # display the table inside the html file, not important.
covPC1<-round((cov(xdata.pca$scores)),3) # Show the covariance matrix for the Components
covPC1 # variances on the diagonal, and then all covariances are 0.
Lambda<-as.matrix(covPC1)
class(Lambda)
sum(diag(Lambda)) # The sum of the variances of the Components = 10 since p=10.
summary(xdata.pca, loadings=TRUE,cutoff=0.0)  # cutoff insures all are displayed
table<-round(cbind("Variance"=xdata.pca$sdev^2,
"%"=100*xdata.pca$sdev^2/sum(xdata.pca$sdev^2),
"Cumulative %"=100*cumsum(xdata.pca$sdev^2)/sum(xdata.pca$sdev^2)),
d=2)
knitr::kable(table) # display the table inside the html file, not important.
pca$sdev^2
xdata$sdev^2
xdata.pca$sdev^2
table<-round(cbind("Variance"=xdata.pca$sdev^2,
"%"=100*xdata.pca$sdev^2/sum(xdata.pca$sdev^2),
"Cumulative %"=100*cumsum(xdata.pca$sdev^2)/sum(xdata.pca$sdev^2)),
d=2)
table<-round(cbind("Variance"=xdata.pca$sdev^2,
"%"=100*xdata.pca$sdev^2/sum(xdata.pca$sdev^2),
"Cumulative %"=100*cumsum(xdata.pca$sdev^2)/sum(xdata.pca$sdev^2)),
d=2)
knitr::kable(table) # display the table inside the html file, not important.
xdata.pca$sdev^2
# provide your R codes here (if possible)
xdata.pca$sdev^2
# provide your R codes here (if possible)
xdata.pca$sdev^2
# provide your R codes here (if possible)
xdata.pca$sdev^2
samplevariance[1:3]
# provide your R codes here (if possible)
samplevariance<-xdata.pca$sdev^2
samplevariance[1:3]
sum(samplevariance[1:3])
screeplot(xdata.pca) # NOTE that this does show the PC variances.
plot(xdata.pca$sdev^2, type="b", pch=16, xlab="Component number",
ylab="Eigenvalue", main="Scree plot for x-variables of fat data")
# provide your R codes here (if possible)
samplevariance<-xdata.pca$sdev^2 #eigenvalues
samplevariance[1:3] #selecting the first three eigenvalues
sum(samplevariance[1:3]) #Summing the first 3 eigen values
plot(xdata.pca$sdev^2, type="b", pch=16, xlab="Component number", #screeplot
ylab="Eigenvalue", main="Scree plot for x-variables of fat data")
install.packages("vegan")
# provide your R codes here (if possible)
samplevariance <- xdata.pca$sdev^2
p <- length(eig)
plot(xdata.pca$sdev^2, type="b", pch=16, xlab="Component number",
ylab="Eigenvalue", main="Scree plot for x-variables of fat data")
screeplot(xdata.pca) # NOTE that this does show the PC variances.
# provide your R codes here (if possible)
samplevariance<-xdata.pca$sdev^2 #eigenvalues
samplevariance[1:3] #selecting the first three eigenvalues
sum(samplevariance[1:3]) #Summing the first 3 eigen values
plot(xdata.pca$sdev^2, type="b", pch=16, xlab="Component number", #screeplot
ylab="Eigenvalue", main="Scree plot for x-variables of fat data")
# provide your R codes here (if possible)
samplevariance <- xdata.pca$sdev^2
p <- length(eig)
# provide your R codes here (if possible)
eig<-xdata.pca$sdev^2 #eigenvalues
eige[1:3] #selecting the first three eigenvalues
# provide your R codes here (if possible)
eig<-xdata.pca$sdev^2 #eigenvalues
eig[1:3] #selecting the first three eigenvalues
sum(eig[1:3]) #Summing the first 3 eigen values
plot(xdata.pca$sdev^2, type="b", pch=16, xlab="Component number", #screeplot
ylab="Eigenvalue", main="Scree plot for x-variables of fat data")
# provide your R codes here (if possible)
eig <- xdata.pca$sdev^2
p <- length(eig)
# broken stick expected proportions for p components
brokenstick_proportions <- sapply(1:p, function(k) sum(1/(k:p)) / p)
# convert to expected eigenvalues on the same scale as eig
bs_eig <- brokenstick_proportions * sum(eig)
# which PCs to retain by broken stick rule
retain <- which(eig > bs_eig)
retain #shows a value of 1
length(retain)
# quick check table
cbind(PC = 1:p, eig = eig, broken_stick = bs_eig, keep = eig > bs_eig)
# plot observed vs broken stick
plot(eig, type = "b", xlab = "Component", ylab = "Eigenvalue")
keep <- eig > bs_eig
keep #True/False table showing which componetns to drop
which(keep)
sum(keep)
keep
bs_prop
# provide your R codes here (if possible)
eig <- xdata.pca$sdev^2
p <- length(eig)
# broken stick expected proportions for p components
bs_prop <- sapply(1:p, function(k) sum(1/(k:p)) / p)
# convert to expected eigenvalues on the same scale as eig
bs_eig <- bs_prop * sum(eig)
# which PCs to retain by broken stick rule
retain <- which(eig > bs_eig)
retain #shows a value of 1
length(retain)
# quick check table
cbind(PC = 1:p, eig = eig, broken_stick = bs_eig, keep = eig > bs_eig)
# plot observed vs broken stick
plot(eig, type = "b", xlab = "Component", ylab = "Eigenvalue")
keep <- eig > bs_eig
keep #True/False table showing which componetns to drop
which(keep)
sum(keep)
keep
bs_prop
out <- data.frame(
  PC = 1:p,
# provide your R codes here (if possible)
eig <- xdata.pca$sdev^2
p <- length(eig)
# broken stick expected proportions for p components
bs_prop <- sapply(1:p, function(k) sum(1/(k:p)) / p)
# convert to expected eigenvalues on the same scale as eig
bs_eig <- bs_prop * sum(eig)
# which PCs to retain by broken stick rule
retain <- which(eig > bs_eig)
retain #shows a value of 1
length(retain)
# quick check table
cbind(PC = 1:p, eig = eig, broken_stick = bs_eig, keep = eig > bs_eig)
# plot observed vs broken stick
plot(eig, type = "b", xlab = "Component", ylab = "Eigenvalue")
keep <- eig > bs_eig
keep #True/False table showing which componetns to drop
which(keep)
sum(keep)
keep
bs_prop
out <- data.frame(
PC = 1:p,
eigenvalue = eig,
broken_stick = bs_eig,
keep = eig > bs_eig
)
out #creates a data table
# provide your R codes here (if possible)
# Run PCA (if not already done)
pca <- prcomp(X, scale. = TRUE)
View(covPC1)
# provide your R codes here (if possible)
# Run PCA (if not already done)
pca <- prcomp(xdata.pca, scale. = TRUE)
# provide your R codes here (if possible)
# Run PCA (if not already done)
# Get scores (principal components)
scores <- xdata.pca$x
# Get scaled X
X_scaled <- scale(X)
# provide your R codes here (if possible)
# Run PCA (if not already done)
# Get scores (principal components)
scores <- xdata.pca$x
# Get scaled X
X_scaled <- scale(xdata.pca)
# provide your R codes here (if possible)
# Run PCA (if not already done)
head(xdata.pca$x)
# Get scores (principal components)
scores <- xdata.pca$x
# Get scaled X
X_scaled <- scale(xdata.pca)
View(xdata)
# provide your R codes here (if possible)
# Run PCA (if not already done)
PCAtry<-head(xdata.pca$x)
# Get scores (principal components)
scores <- xdatapca$x
# provide your R codes here (if possible)
# Run PCA (if not already done)
PCAtry<-head(xdata.pca$x)
# provide your R codes here (if possible)
# Run PCA (if not already done)
PCAtry <- head(xdata.pca$x)
# provide your R codes here (if possible)
# Run PCA (if not already done)
PCAtry <- head(xdata.pca$scores)
View(PCAtry)
pca_scores <- as.data.frame(xdata.pca$scores[,1:3])
Colnames(pca_scores) <- c("PC1","PC2","PC3")
colnames(pca_scores) <- c("PC1","PC2","PC3")
loadings <- as.matrix(xdata.pca$loadings[, 1:3]) #extract the PCA loadings from the larger dataframe
sdev <- xdata.pca$sdev[1:3] #extract the component standard deviations
cor_x_pc <- sweep(loadings, 2, sdev, FUN = "*") #compute correlations; Multiply each column of loadings by the corresponding component standard deviation values
cor_x_pc
cutoff <- 0.4
apply(cor_x_pc, 2, function(x) names(x)[abs(x) >= cutoff])
cor_table <- data.frame(
variable = rownames(cor_x_pc),
PC1_cor = cor_x_pc[,1],
PC2_cor = cor_x_pc[,2],
PC3_cor = cor_x_pc[,3],
PC1_related = abs(cor_x_pc[,1]) >= cutoff,
PC2_related = abs(cor_x_pc[,2]) >= cutoff,
PC3_related = abs(cor_x_pc[,3]) >= cutoff
) #regression table
#ways of representing and visualizing results:
cor_table
biplot(xdata.pca, choices = c(1, 2), scale = 0)
biplot(xdata.pca, choices = c(1, 3), scale = 0)
loadings <- as.matrix(xdata.pca$loadings[, 1:3])
loadings
# Get the standardized xdata first
Xscaled<-scale(xdata, center = TRUE, scale = TRUE)
round(cor(xdata.pca$scores, Xscaled,),3)
